apiVersion: "api.cerbos.dev/v1"
derivedRoles:
    name: common_roles
    definitions:
        - name: owner-account
          parentRoles: ["user"]
          condition:
              match:
                  expr: request.resource.attr.user_id == request.principal.attr.user_id

        - name: owner-provider
          parentRoles: ["user"]
          condition:
              match:
                  expr: request.resource.attr.user_id == request.principal.attr.user_id

        - name: provider
          parentRoles: ["user"]
          condition:
              match:
                  expr: request.resource.attr.provider_id == request.principal.attr.provider_id
